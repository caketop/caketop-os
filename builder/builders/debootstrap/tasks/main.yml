---
- import_role:
    name: builder_cache
  vars:
    cache_action: validate

- block:
  - name: Run debootstrap
    command:
      argv:
        - debootstrap
        - --variant={{ debootstrap_variant }}
        - --include={{ debootstrap_include }}
        - "{{ debootstrap_suite }}"
        - /mnt/cache/debootstrap
        - "{{ debootstrap_mirror }}"
      creates: /mnt/cache/debootstrap
    environment: "{{ proxy_env }}"
  - import_role:
      name: builder_cache
    vars:
      cache_action: update
  when: not debootstrap_cached
